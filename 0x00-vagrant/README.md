This contains the main work
